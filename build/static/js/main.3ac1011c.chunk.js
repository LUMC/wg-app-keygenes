(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{366:function(e,t,n){e.exports=n(586)},584:function(e,t,n){},586:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(51),o=n.n(l),c=n(88),i=n(28),s=n(303),u=n(33),p=n.n(u),m=n(53),d=n(41),g=n(45),f=n(47),h=n(46),E=n(48),v=n(598),y=n(325),b=n(605),C=n(593),S=n(327),w=n(324),T=n(169),G=n(89),O=n(50),_=Object(O.a)(),k=n(304),x=n.n(k),j=n(66),A={exit:{opacity:0,y:20},enter:{opacity:1,y:0,delay:function(e){return 60*e.charIndex}}},D=function(e){function t(){return Object(d.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(g.a)(t,[{key:"renderSubMenu",value:function(e){return e.length<1?null:r.a.createElement(v.a,{text:"More",pointing:!0,className:"link item"},r.a.createElement(v.a.Menu,null,e.map(function(e,t){return r.a.createElement(v.a.Item,{name:e.reference,key:"menuItem-".concat(t),as:T.a,to:"/"+e.reference},e.name)})))}},{key:"renderMenu",value:function(){if(this.props.menu.length<1)return null;var e=[];return r.a.createElement(y.a,{inverted:!0,widths:6,className:"mainMenu",pointing:!0,secondary:!0,stackable:!0},r.a.createElement(G.b,{history:_},this.props.menu.map(function(t,n){return t.subitem?(e.push(t),null):r.a.createElement(y.a.Item,{name:t.reference,key:"menuItem-".concat(n),as:T.a,to:"/"+t.reference},t.name)}),this.renderSubMenu(e)))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"appContent"},r.a.createElement("div",{className:"welcome"},r.a.createElement(j.BrowserView,null,r.a.createElement(b.a,{visible:this.props.sloganText,animation:"fade up",duration:{show:2e3}},r.a.createElement("div",null,r.a.createElement(x.a,{className:"particles",params:{particles:{number:{value:40},size:{value:3}}}})))),r.a.createElement(C.a,null,r.a.createElement(S.a,{columns:1},r.a.createElement(S.a.Row,{verticalAlign:"middle",className:"welcome-box"},r.a.createElement(S.a.Column,{textAlign:"center"},r.a.createElement("div",{className:"introName"},r.a.createElement(w.a,{initialPose:"exit",pose:"enter",charPoses:A},this.props.applicationDetails.title)),r.a.createElement("div",{className:"sloganText"},r.a.createElement(b.a,{unmountOnHide:!1,visible:this.props.sloganText,animation:"fade up",duration:{show:1e3}},r.a.createElement("div",null,this.props.applicationDetails.sub_title))))),r.a.createElement(b.a,{unmountOnHide:!1,visible:this.props.sloganText,animation:"fade down",duration:{show:800}},r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,null,this.renderMenu())))))),r.a.createElement(b.a,{unmountOnHide:!1,visible:this.props.sloganText,animation:"fade up",duration:{show:1e3}},r.a.createElement("div",{className:"page-section"},r.a.createElement(C.a,null,this.props.activePageContent)))))}}]),t}(a.Component),N=n(213),I=n(602),P=n(596),M=n(78),R=n(22),F=n.n(R),V=(n(479),n(172)),L=n.n(V),U="http://165.22.196.58:8080/keygenes/",H=L.a.create({baseURL:U}),B="application configuration could not be received from API",q="config item is assigned to an unknown module",z="module config does not contain the required attrs",J="reference alias doesn't refer to an item",K=function(e){return F.a.values(F.a.filter(e,function(e){return"published"===e.status||"published"===e.published}))},X=function(e,t){return t.every(function(t){return Object.keys(e).includes(t)})},Q=function(e,t){return t.hasOwnProperty(e)},W=function e(){Object(d.a)(this,e)};W.config=function(e){console.error("Configuration error -  ".concat(e))},W.module=function(e){console.error("Module error -  ".concat(e))},W.moduleAttr=function(e,t){console.error("Module error -  ".concat(e," ").concat(z,": ").concat(t))};var Y,Z="SET_CONFIG",$="ADD_COLLECTION",ee="PROTOCOL_COMPLETED",te="PROTOCOL_FAILED",ne="GET_APPLICATION_DONE",ae={GET_SUGGESTIONS:"GET_SUGGESTIONS",SET_ACTIVE_GENE:"SET_ACTIVE_GENE",GET_GENE_COUNTS:"GET_GENE_COUNTS",SET_ACTIVE_TISSUE:"SET_ACTIVE_TISSUE",SET_ACTIVE_STAGE:"SET_ACTIVE_STAGE"},re=n(587),le=n(132),oe=function(e){switch(e.setting.config.type){case"github":return r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,{textAlign:"center"},r.a.createElement("a",{href:e.setting.config.config.link,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(re.a,{as:"div",labelPosition:"right"},r.a.createElement(re.a,{color:"blue"},r.a.createElement(M.a,{name:"github"}),"GitHub"),r.a.createElement(le.a,{basic:!0,pointing:"left"},e.setting.config.config.label)))));case"download":return r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,{textAlign:"center"},r.a.createElement("a",{href:e.setting.config.config.link,download:!0,target:"_blank"},r.a.createElement(re.a,{icon:!0,labelPosition:"left"},r.a.createElement(M.a,{name:"cloud"}),e.setting.config.config.label))));default:return W.module("Button not rendered, type: ".concat(e.moduleName," not found")),null}},ce=n(173),ie=n.n(ce),se=n(604),ue=["reference_alias","content"],pe=function(e){if(e.collection){if(!X(e.collection[0],ue))return W.moduleAttr("content",ue),null;var t=F.a.keyBy(e.collection,"reference_alias");return Q(e.setting.alias_ref,t)?r.a.createElement(r.a.Fragment,null,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"h2";return e?r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,null,r.a.createElement(se.a,{as:t},e))):null}(t[e.setting.alias_ref].title),r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,null,ie()(t[e.setting.alias_ref].content)))):(W.module(J),null)}return null},me=n(306),de=n.n(me),ge=["icon","title","step_name","description","tags"],fe=function(e){return e.collection?X(e.collection[0],ge)?r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,{className:"timeLine"},e.collection.map(function(e,t){var n=(t+1)%2===1?"left":"right";return r.a.createElement(de.a,{key:"timelineItem-".concat(t),className:"time-item",direction:n,icon:e.icon,title:e.title,time:"".concat(t+1," ").concat(e.step_name),description:e.description,color:"blue",tags:e.tags,lineHeight:t})}))):(W.moduleAttr("tool_steps",ge),null):null},he=n(326),Ee=n(599),ve=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"h2";return e?r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,null,r.a.createElement(se.a,{as:t},e))):null},ye=function(e){var t=["icon","title","description"];if(!X(e.collection[0],t))return W.moduleAttr("tool_steps",t),null;var n=F.a.keyBy(e.collection,"reference_alias");return Q(e.setting.alias_ref,n)?r.a.createElement(r.a.Fragment,null,ve(e.setting.title),r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,null,r.a.createElement(Ee.a,{divided:!0,relaxed:!0},e.collection.map(function(t,n){return r.a.createElement(Ee.a.Item,{key:"list-icon-".concat(n,"-").concat(e.setting.collection)},r.a.createElement(Ee.a.Icon,{name:t.icon,size:"large",verticalAlign:"top"}),r.a.createElement(Ee.a.Content,null,r.a.createElement(Ee.a.Header,{as:"a"},t.title),r.a.createElement(Ee.a.Description,{as:"a"},t.description)))}))))):(W.module(J),null)},be=function(e){var t=["link","title","description"];if(!X(e.collection[0].items[0],t))return W.moduleAttr("tool_steps",t),null;var n=F.a.keyBy(e.collection,"reference_alias");return Q(e.setting.alias_ref,n)?r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,null,ve(e.setting.title,"h3"),r.a.createElement(Ee.a,null,n[e.alias_ref].items.map(function(e,t){return r.a.createElement(Ee.a.Item,{key:"download-list-".concat(t)},r.a.createElement(he.a,{avatar:!0},r.a.createElement("a",{href:e.link,download:!0},r.a.createElement(M.a,{avatar:"true",circular:!0,inverted:!0,name:"download"}))),r.a.createElement(Ee.a.Content,null,r.a.createElement(Ee.a.Header,null,e.title),e.description))})))):(W.module(J),null)},Ce=function(e){if(e.collection)switch(e.setting.config.type){case"icon-list":return ye(e);case"download-list":return be(e);default:return null}return null},Se=function(e){if(e.collection){var t=["question","answer"];return X(e.collection[0],t)?r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,null,e.collection.map(function(e,t){return r.a.createElement("div",{key:"question-answer-".concat(t)},r.a.createElement("p",null,r.a.createElement("b",null,"Q: ",e.question)),ie()(e.answer),r.a.createElement("br",null))}))):(W.moduleAttr("faqs",t),null)}return null},we=n(601),Te=function(e){try{return e.image.data.full_url}catch(t){return"https://via.placeholder.com/150"}},Ge=function(e){if(e.collection){var t=["name","job_description","year_joined"];return X(e.collection[0],t)?r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,null,r.a.createElement(we.a.Group,{textAlign:"center",itemsPerRow:j.isBrowser||j.isTablet?3:1},e.collection.map(function(e,t){return function(e,t){return r.a.createElement(we.a,{key:"contact-card-".concat(t)},r.a.createElement(he.a,{src:Te(e),wrapped:!0,ui:!1}),r.a.createElement(we.a.Content,null,r.a.createElement(we.a.Header,null,e.name),r.a.createElement(we.a.Meta,null,r.a.createElement("span",{className:"date"},"Joined in ",e.year_joined,e.year_left?", left in "+e.year_left:"")),r.a.createElement(we.a.Description,null,e.job_description)),r.a.createElement(we.a.Content,{extra:!0},r.a.createElement(M.a,{name:"mail"}),e.email))}(e,t)})))):(W.moduleAttr("contact-cards",t),null)}return null},Oe=n(597),_e=n(205),ke=n(298),xe=n(299),je=function(e){return e?void 0:"Required"},Ae=(Y=5,n(594),n(595)),De=function(e,t,n,a){return r.a.createElement(Oe.a.Field,null,r.a.createElement("label",null,t),r.a.createElement(Ae.a,Object.assign({},e,a,{autoComplete:"off"})),function(e){var t=e.touched,n=e.error;if(t&&n)return r.a.createElement("div",{className:"errorMessage"},n)}(n))},Ne=n(214),Ie=function(e){var t=e.input,n=(t.value,Object(Ne.a)(t,["value"])),a=e.meta,l=Object(Ne.a)(e,["input","meta"]);return r.a.createElement(Oe.a.Field,null,r.a.createElement("label",null,l.label),r.a.createElement(Ae.a,Object.assign({type:"file"},n,l.input,{autoComplete:"off"})),function(e){var t=e.touched,n=e.error;if(t&&n)return r.a.createElement("div",{className:"errorMessage"},n)}(a))},Pe=function(e,t,n,a){return r.a.createElement(Oe.a.Field,null,r.a.createElement("label",null,t),r.a.createElement(v.a,Object.assign({selection:!0},e,a,{value:e.value,onChange:function(t,n){return e.onChange(n.value)},placeholder:t})),function(e){var t=e.touched,n=e.error;if(t&&n)return r.a.createElement("div",{className:"errorMessage"},n)}(n))},Me=function(e){var t=e.input,n=e.label,a=e.meta,r=e.inputAttr;return De(t,n,a,r)},Re=function(e){return Ie(e)},Fe=function(e){var t=e.input,n=e.label,a=e.meta,r=e.inputAttr;return Pe(t,n,a,r)},Ve=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(l)))).state={fileInputCode:"fileCode"},n.onSubmit=function(e,t){n.props.onSubmit(n.props.collection.form[0],e),t(Object(_e.a)("mainForm")),n.setState({fileInputCode:Math.random().toString(36).substring(7)})},n.renderInputType=function(e,t){switch(e.input_type.type){case"text":return r.a.createElement(ke.a,{key:"field-input-".concat(t),name:e.api_reference_parameter,component:Me,validate:[je],label:e.label,inputAttr:{placeholder:"Enter the ".concat(e.label.toLowerCase()),type:"text"}});case"file":return r.a.createElement(ke.a,{key:"field-input-".concat(t,"-").concat(n.state.fileInputCode),name:e.api_reference_parameter,component:Re,label:e.label,inputAttr:{placeholder:"Enter the ".concat(e.label.toLowerCase())}});case"select":var a=n.createOptions(t,e.option_titles,e.option_values);return r.a.createElement(ke.a,{key:"field-input-".concat(t),name:e.api_reference_parameter,component:Fe,validate:[je],label:e.label,inputAttr:{placeholder:"Enter the ".concat(e.label.toLowerCase()),options:a}});default:return null}},n.createOptions=function(e,t,n){var a=[];return t.forEach(function(r,l){a.push({key:"optionItem-".concat(e,"-").concat(l),text:t[l],value:n[l]})}),a},n}return Object(E.a)(t,e),Object(g.a)(t,[{key:"renderForm",value:function(){return this.props.collection.inputs.length<1?r.a.createElement("b",null,r.a.createElement("i",null,"Form under construction!")):r.a.createElement("div",null,this.renderInputs(),r.a.createElement(re.a,{type:"submit",icon:!0,labelPosition:"left",size:"large",floated:"right"},r.a.createElement(M.a,{name:"paper plane"}),"Run!"))}},{key:"renderInputs",value:function(){var e=this;return this.props.collection.inputs.map(function(t,n){return e.renderInputType(t,n)})}},{key:"render",value:function(){if(!this.props.collection.inputs)return null;var e="form:form",t=["title","api","tool_reference","description"];return X(this.props.collection.form[0],t)?(e="form:inputs",t=["api_reference_parameter","label","input_type"],X(this.props.collection.inputs[0],t)?r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,null,this.props.protocolStatus===ee?r.a.createElement(b.a,{transitionOnMount:!0,animation:"slide down",duration:{show:1e3}},r.a.createElement(N.a,{color:"green"},r.a.createElement("b",null,"Algorithm executed!")," Dataset will be in your mail when ready")):"",this.props.protocolStatus===te?r.a.createElement(b.a,{transitionOnMount:!0,animation:"slide down",duration:{show:1e3}},r.a.createElement(N.a,{color:"red"},r.a.createElement("b",null,"Algorithm encountered an error!")," please make sure the configuration is setup correctly")):"",r.a.createElement("h3",null,"Configuration"),r.a.createElement(Oe.a,{onSubmit:this.props.handleSubmit(this.onSubmit)},this.renderForm()))):(W.moduleAttr(e,t),null)):(W.moduleAttr(e,t),null)}}]),t}(a.Component),Le=Object(xe.a)({form:"mainForm"})(Ve),Ue=n(212),He=n(603),Be=n(176),qe=n.n(Be),ze={isLoading:!1,value:"",selected:!1,tissues:[],stages:[],graphSetting:"all"},Je=function(e){function t(){var e;return Object(d.a)(this,t),(e=Object(f.a)(this,Object(h.a)(t).call(this))).state=ze,e.mapTissues=function(t){return t.map(function(t){return e.state.tissues[t]})},e.generatePlotTraces=function(t){if("sex"===e.state.graphSetting)return[];var n=[],a=F.a.groupBy(t,"stage"),r=e.state.stages;return Object.keys(a).forEach(function(t){var l=F.a.remove(a[t],function(e){return"nan"!==e.count}),o={x:e.mapTissues(F.a.map(l,"tissue")),y:F.a.map(l,"CPM"),mode:"markers",type:"scatter",name:r[t],opacity:.5,marker:{size:20}};n.push(o)}),n},e.generateSexPlotTraces=function(t){if("stage"===e.state.graphSetting)return[];var n=[],a=F.a.groupBy(t,"sex"),r={F:"Female",M:"Male"};return Object.keys(a).forEach(function(t){var l=F.a.remove(a[t],function(e){return"nan"!==e.count}),o={x:e.mapTissues(F.a.map(l,"tissue")),y:F.a.map(l,"CPM"),mode:"markers",type:"scatter",name:r[t],opacity:"all"===e.state.graphSetting?.1:.5,marker:{symbol:1,size:"all"===e.state.graphSetting?40:20}};n.push(o)}),n},e.setGraph=function(t){e.setState({graphSetting:t})},e.handleResultSelect=function(t,n){var a=n.result;e.props.setGene(a),e.setState({value:a.ensg,selected:!0}),e.props.getGeneCounts(a.id)},e.handleSearchChange=function(t){e.props.getGeneSuggestions(t.target.value),e.setState({value:t.target.value,selected:!1})},e}return Object(E.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.setState({tissues:F.a.chain(this.props.collection.tissue).keyBy("id").mapValues("name").value()}),this.setState({stages:F.a.chain(this.props.collection.stage).keyBy("id").mapValues("name").value()})}},{key:"renderGraph",value:function(){var e=this;if(this.props.moduleData.geneCounts.length>0){var t=this.generatePlotTraces(this.props.moduleData.geneCounts),n=this.generateSexPlotTraces(this.props.moduleData.geneCounts);return r.a.createElement(r.a.Fragment,null,r.a.createElement("center",null,r.a.createElement(re.a.Group,null,r.a.createElement(re.a,{active:"stage"===this.state.graphSetting,onClick:function(){return e.setGraph("stage")}},"stages"),r.a.createElement(re.a,{active:"sex"===this.state.graphSetting,onClick:function(){return e.setGraph("sex")}},"sex"),r.a.createElement(re.a,{active:"all"===this.state.graphSetting,onClick:function(){return e.setGraph("all")}},"all"))),r.a.createElement(qe.a,{className:"full-size large",data:[].concat(Object(Ue.a)(n),Object(Ue.a)(t)),layout:{showlegend:!0,height:600,hovermode:"closest",title:"Expression in ".concat(this.props.moduleData.activeGene.ensg," \n").concat(this.props.moduleData.activeGene.symbol?" (".concat(this.props.moduleData.activeGene.symbol,")"):"").concat(this.props.moduleData.activeGene.description?" - ".concat(this.props.moduleData.activeGene.description):""),yaxis:{title:"Counts per million (CPM)"},xaxis:{categoryarray:F.a.map(this.state.tissues,function(e){return e})}}}))}return this.state.selected?r.a.createElement("div",null,r.a.createElement(N.a,null,r.a.createElement(I.a,{active:!0,inverted:!0},r.a.createElement(P.a,{content:"Preparing expression data..."})),r.a.createElement(he.a,{src:"https://react.semantic-ui.com/images/wireframe/short-paragraph.png"}))):null}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.value,a=e.tissues,l=e.stages;return a.length<1||l.length<1?r.a.createElement("div",null,r.a.createElement(N.a,null,r.a.createElement(I.a,{active:!0,inverted:!0},r.a.createElement(P.a,{content:"Loading"})),r.a.createElement(he.a,{src:"https://react.semantic-ui.com/images/wireframe/short-paragraph.png"}))):r.a.createElement(S.a,null,r.a.createElement(S.a.Row,{centered:!0},r.a.createElement(S.a.Column,{width:8},r.a.createElement(Oe.a,null,r.a.createElement(Oe.a.Field,null,r.a.createElement("label",null,"Search using the gene symbol,ensembl id or gene description"),r.a.createElement(He.a,Object.assign({loading:t,onResultSelect:this.handleResultSelect,onSearchChange:F.a.debounce(this.handleSearchChange,500,{leading:!0}),results:this.props.moduleData.suggestions,value:n},this.props)))))),r.a.createElement(S.a.Row,{centered:!0},r.a.createElement(S.a.Column,{width:16},r.a.createElement("center",null,this.renderGraph()))))}}]),t}(a.Component),Ke=n(606),Xe=n(600),Qe=(n(567),n(582),n(323)),We=n.n(Qe),Ye={stages:[],options:[],searchTerm:"",downloadData:[],stageOptions:[{key:1,text:"all",value:-1},{key:2,text:"adult",value:1},{key:3,text:"fetal",value:0}],stageActive:-1,stageName:"all"},Ze=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(l)))).state=Ye,n.setActiveTissue=function(e,t){n.props.setTissue({id:t.value,text:e.target.innerText},n.state.stageActive)},n.generatePlotTraces=function(e,t){e=F.a.map(e,function(e){if(t.includes(e.symbol))return e}),e=F.a.compact(e);var a=[],r=F.a.groupBy(e,"stage"),l=n.state.stages;return Object.keys(r).forEach(function(e){var t=F.a.remove(r[e],function(e){return"nan"!==e.count}),n={x:F.a.map(t,"symbol"),y:F.a.map(t,"CPM"),mode:"markers",type:"scatter",name:l[e],opacity:.5,marker:{size:20}};a.push(n)}),a},n.renderTableContent=function(){var e=n.props.moduleData.tissueGenes.map(function(e,t){return e.ensg.includes(n.state.searchTerm)||e.symbol.includes(n.state.searchTerm)||e.description.includes(n.state.searchTerm)?r.a.createElement(Xe.a.Row,{key:"tissueItem-".concat(t)},r.a.createElement(Xe.a.Cell,null,t+1),r.a.createElement(Xe.a.Cell,null,r.a.createElement("a",{className:"tableLink",href:"https://www.ensembl.org/Homo_sapiens/Gene/Summary?db=core;g=".concat(e.ensg),target:"_blank"},e.ensg)),r.a.createElement(Xe.a.Cell,null,e.symbol),r.a.createElement(Xe.a.Cell,null,e.description),r.a.createElement(Xe.a.Cell,null,e.CPM_avg)):null});return F.a.compact(e)},n.setActiveStage=function(e,t){n.setState({stageActive:t.value}),n.setState({stageName:e.target.innerText}),""!=n.props.moduleData.activeTissue.id&&n.props.setTissue(n.props.moduleData.activeTissue,t.value)},n.filterGeneResults=function(e){n.setState({searchTerm:e.target.value})},n.renderDownloadData=function(){return F.a.compact(F.a.map(n.props.moduleData.tissueGenes,function(e){return{ENSG:e.ensg,Symbol:e.symbol,AVG_count:e.count_avg,Description:e.description}}))},n}return Object(E.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.setState({stages:F.a.chain(this.props.collection.stage).keyBy("id").mapValues("name").value()}),this.setState({options:F.a.map(this.props.collection.tissue,function(e){return{key:e.id,text:e.name,value:e.id}})})}},{key:"renderGraph",value:function(){if(this.props.moduleData.tissueCounts.length>0){var e=F.a.map(this.props.moduleData.tissueGenes,function(e,t){return t<20?e.symbol:null});e=F.a.compact(e);var t=this.generatePlotTraces(this.props.moduleData.tissueCounts,e);return console.log(e),r.a.createElement(r.a.Fragment,null,r.a.createElement(se.a,{as:"h3",dividing:!0},"Top 20 expressed genes in ",this.state.stageName," ",this.props.moduleData.activeTissue.text," tissue"),r.a.createElement("center",null,r.a.createElement(qe.a,{className:"full-size large",data:t,layout:{showlegend:!0,height:600,hovermode:"closest",xaxis:{categoryarray:F.a.values(e)},yaxis:{title:"Counts per million (CPM)"}}})))}return this.state.selected?r.a.createElement("div",null,r.a.createElement(N.a,null,r.a.createElement(I.a,{active:!0,inverted:!0},r.a.createElement(P.a,{content:"Preparing transcription data..."})),r.a.createElement(he.a,{src:"https://react.semantic-ui.com/images/wireframe/short-paragraph.png"}))):0===this.props.moduleData.geneCounts.length&&""!=this.props.moduleData.activeTissue?r.a.createElement("div",null,r.a.createElement("center",null,r.a.createElement("b",null,"No gene expression found!"))):null}},{key:"renderTable",value:function(){return!this.props.moduleData.tissueGenes.length>0?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(se.a,{as:"h3",dividing:!0},"Top 100 expressed genes in ",this.state.stageName," ",this.props.moduleData.activeTissue.text," tissue"),r.a.createElement(Oe.a,null,r.a.createElement(Oe.a.Group,null,r.a.createElement(Oe.a.Field,{width:10},r.a.createElement(Ae.a,{onChange:this.filterGeneResults,action:{icon:"search"},placeholder:"Search..."})),r.a.createElement(Oe.a.Field,{width:3},r.a.createElement(We.a,{filename:"KeyGenes-".concat(this.props.moduleData.activeTissue.text,"-tissue.csv"),data:this.renderDownloadData(),className:" primary ui labeled icon button"},r.a.createElement("i",{className:"file icon right"}),"Save table (.CSV)")))),r.a.createElement(Xe.a,{basic:!0},r.a.createElement(Xe.a.Header,null,r.a.createElement(Xe.a.Row,null,r.a.createElement(Xe.a.HeaderCell,null,"#"),r.a.createElement(Xe.a.HeaderCell,null,"ENSG"),r.a.createElement(Xe.a.HeaderCell,null,"Symbol"),r.a.createElement(Xe.a.HeaderCell,null,"Description"),r.a.createElement(Xe.a.HeaderCell,null,"Average CPM"))),r.a.createElement(Xe.a.Body,null,this.renderTableContent())))}},{key:"render",value:function(){var e=this.props.moduleData.activeTissue.id;return r.a.createElement(S.a,null,r.a.createElement(S.a.Row,{centered:!0},r.a.createElement(S.a.Column,{width:8},r.a.createElement(Oe.a,null,r.a.createElement(Oe.a.Field,null,r.a.createElement("label",null,"Select a development stage"),r.a.createElement(v.a,{value:this.state.stageActive,placeholder:"Stage",search:!0,selection:!0,options:this.state.stageOptions,onChange:this.setActiveStage})),r.a.createElement(Oe.a.Field,null,r.a.createElement("label",null,"Select a tissue"),r.a.createElement(v.a,{value:e,placeholder:"Tissue",search:!0,selection:!0,options:this.state.options,onChange:this.setActiveTissue}))))),r.a.createElement(S.a.Row,{centered:!0},r.a.createElement(S.a.Column,{width:16},this.renderGraph())),r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,{width:16},this.renderTable())))}}]),t}(a.Component),$e=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(l)))).panes=[{menuItem:{key:"genefinder",icon:"dna",content:"Search a gene"},render:function(){return r.a.createElement(Ke.a.Pane,{attached:!1},r.a.createElement(Je,{collection:n.props.collection,moduleData:n.props.moduleData,getGeneSuggestions:n.props.getGeneSuggestions,setGene:n.props.setGene,setting:n.props.setting,getGeneCounts:n.props.getGeneCounts}))}},{menuItem:{key:"tissueFinder",icon:"heart",content:"View tissues"},render:function(){return r.a.createElement(Ke.a.Pane,{attached:!1},r.a.createElement(Ze,{collection:n.props.collection,setTissue:n.props.setTissue,moduleData:n.props.moduleData}))}}],n}return Object(E.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){return j.isMobile?r.a.createElement("p",null,"The KeyGenes browser module is only accessible by desktop or tablet!"):r.a.createElement(S.a.Column,{width:16},r.a.createElement(Ke.a,{menu:{secondary:!0,pointing:!0},panes:this.panes}))}}]),t}(a.Component),et=function(e){switch(e.setting.module){case"content":return r.a.createElement(pe,{setting:e.setting,collection:e.collection});case"button":return r.a.createElement(oe,{setting:e.setting});case"tool_steps":return j.isMobile?null:r.a.createElement(fe,{collection:e.collection});case"list":return r.a.createElement(Ce,{alias_ref:e.setting.alias_ref,setting:e.setting,collection:e.collection});case"faqs":return r.a.createElement(Se,{collection:e.collection});case"contact-cards":return r.a.createElement(Ge,{collection:e.collection});case"form":return r.a.createElement(Le,{onSubmit:e.onSubmit,collection:e.collection,protocolStatus:e.protocolStatus});case"transcript-finder":return r.a.createElement($e,{collection:e.collection,moduleData:e.modulesData.geneFinder,getGeneSuggestions:e.getGeneSuggestions,setTissue:e.setTissue,setGene:e.setGene,setting:e.setting,getGeneCounts:e.getGeneCounts});default:return W.module(q),null}},tt=function(e){function t(){return Object(d.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(g.a)(t,[{key:"getCollection",value:function(e){return e&&e in this.props.collections?this.props.collections[e]:null}},{key:"renderModules",value:function(){var e=this;return this.props.config.settings.map(function(t,n){return"form"===t.module?r.a.createElement(et,{getGeneSuggestions:e.props.getGeneSuggestions,getGeneCounts:e.props.getGeneCounts,onSubmit:e.props.onSubmit,page:e.props.config.name,key:"module-".concat(e.props.config.reference,"-").concat(n),collection:{form:e.getCollection(t.collection),inputs:e.getCollection("inputs")},setting:t,protocolStatus:e.props.protocolStatus}):"transcript-finder"===t.module?r.a.createElement(et,{setTissue:e.props.setTissue,modulesData:e.props.modulesData,setGene:e.props.setGene,getGeneSuggestions:e.props.getGeneSuggestions,getGeneCounts:e.props.getGeneCounts,page:e.props.config.name,key:"module-".concat(e.props.config.reference,"-").concat(n),collection:{tissue:e.getCollection("tissue"),stage:e.getCollection("stage")},setting:t}):r.a.createElement(et,{modulesData:e.props.modulesData,setGene:e.props.setGene,getGeneSuggestions:e.props.getGeneSuggestions,getGeneCounts:e.props.getGeneCounts,page:e.props.config.name,key:"module-".concat(e.props.config.reference,"-").concat(n),collection:e.getCollection(t.collection),setting:t})})}},{key:"render",value:function(){return this.props.path?r.a.createElement(S.a,null,r.a.createElement(S.a.Row,null,r.a.createElement(S.a.Column,null,r.a.createElement(se.a,{as:"h1",dividing:!0},this.props.config.name))),this.renderModules()):null}}]),t}(a.Component),nt=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={menu:[],sloganText:!1,pageView:!1,render:!1,config:!1},n.onSubmit=function(e,t){switch(e.api.protocol){case"direct":n.props.directProtocol(e,t);break;default:console.log("No valid protocol connected to form")}},n.getCollections=function(){var e=[];return n.props.config.forEach(function(t){t.settings.forEach(function(t){t.collection?("form"===t.collection&&(e.push(t.collection),e.push("inputs")),e.push(t.collection)):"transcript-finder"===t.module&&(e.push("tissue"),e.push("stage"))})}),F.a.uniq(e)},n.loadConfig=Object(m.a)(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.getApplication();case 2:return e.next=4,n.props.getConfig();case 4:return t=n.getCollections(),e.next=7,n.props.getCollections(t);case 7:n.setState({menu:n.props.config});case 8:case"end":return e.stop()}},e)})),n.wrapTransition=function(e){return e},n}return Object(E.a)(t,e),Object(g.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.setState({config:!0})}},{key:"componentDidMount",value:function(){var e=this;this.loadConfig(),setTimeout(function(){this.setState({render:!0})}.bind(this),2e3),setTimeout(function(){e.setState({sloganText:!0})},1200)}},{key:"renderRoutes",value:function(){var e=this;return this.props.config.map(function(t){return r.a.createElement(G.a,{key:"route-".concat(t.reference),path:"/"+t.reference,exact:!0,render:function(n){return e.wrapTransition(r.a.createElement(tt,Object.assign({},n,{setTissue:e.props.setTissue,modulesData:e.props.modules,getGeneSuggestions:e.props.getGeneSuggestions,setGene:e.props.setGene,getGeneCounts:e.props.getGeneCounts,path:"/"+t.reference,config:t,collections:e.props.collections,onSubmit:e.onSubmit,protocolStatus:e.props.protocolStatus})))}})})}},{key:"renderContent",value:function(){var e=this;return 0===this.props.config.length?null:r.a.createElement(G.b,{history:_},r.a.createElement(G.c,null,r.a.createElement(G.a,{path:"/",exact:!0,render:function(t){return e.wrapTransition(r.a.createElement(tt,Object.assign({},t,{modulesData:e.props.modules,getGeneSuggestions:e.props.getGeneSuggestions,setGene:e.props.setGene,setTissue:e.props.setTissue,getGeneCounts:e.props.getGeneCounts,path:"/"+e.props.config[0].reference,config:e.props.config[0],collections:e.props.collections,protocolStatus:e.props.protocolStatus,onSubmit:e.onSubmit})))}}),this.renderRoutes()))}},{key:"render",value:function(){return this.state.render&&!F.a.isEmpty(this.props.config)?(document.documentElement.style.setProperty("--color-primary",this.props.application.primary_color),r.a.createElement(D,{applicationDetails:this.props.application,activePageContent:this.renderContent(),collections:this.props.collections,config:this.props.config,menu:this.props.config})):this.state.render?(W.config(B),r.a.createElement(N.a,{className:"loading-segment"},r.a.createElement(I.a,{active:!0},r.a.createElement(M.a,{name:"close",size:"huge",inverted:!0,color:"grey"}),r.a.createElement("br",null),r.a.createElement("p",null,"Failed to load website")))):r.a.createElement(N.a,{className:"loading-segment"},r.a.createElement(I.a,{active:!0},r.a.createElement(P.a,{indeterminate:!0,inline:"centered"},"Preparing the ","KeyGenes"," website")))}}]),t}(a.Component),at=Object(c.b)(function(e){return{config:F.a.values(e.config),collections:e.collections,protocolStatus:e.protocolStatus,application:e.application[0],modules:e.modules}},{getConfig:function(){return function(){var e=Object(m.a)(p.a.mark(function e(t){var n,a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.get("items/config");case 2:n=e.sent,a=K(n.data.data),t({type:Z,payload:a});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},getApplication:function(){return function(){var e=Object(m.a)(p.a.mark(function e(t){var n,a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.get("items/application");case 2:n=e.sent,a=K(n.data.data),t({type:ne,payload:a});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},getCollections:function(e){return function(t){var n=0,a={};e.forEach(function(){var r=Object(m.a)(p.a.mark(function r(l){var o;return p.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,H.get("items/"+l+"?fields=*.*.*");case 2:o=r.sent,a[l]=K(o.data.data),++n===e.length&&t({type:$,payload:a});case 6:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}())}},directProtocol:function(e,t){return function(){var n=Object(m.a)(p.a.mark(function n(a){var r;return p.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(r=new FormData).set("email",t.email),r.set("training",t.training),r.append("file",t.file[0]),n.next=6,L()({method:"post",url:e.tool_reference,data:r,config:{headers:{"Content-Type":"multipart/form-data",Accept:"text/html"}}});case 6:n.sent.data.includes("Succesfully submitted. Please check your email in a few minutes")?a({type:ee}):a({type:te});case 8:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()},getGeneSuggestions:function(e){return function(){var t=Object(m.a)(p.a.mark(function t(n){var a;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H.get("/items/gene?limit=5&filter[symbol][logical]=or&\n    filter[symbol][rlike]=".concat(e,"%&filter[description][logical]=or&\n    filter[description][rlike]=").concat(e,"%&filter[ensg][logical]=or&filter[ensg][rlike]=").concat(e,"%\n    &filter[symbol][nnull]"));case 2:a=t.sent,n({type:ae.GET_SUGGESTIONS,payload:a.data.data});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},setGene:function(e){return{type:ae.SET_ACTIVE_GENE,payload:e}},getGeneCounts:function(e){return function(){var t=Object(m.a)(p.a.mark(function t(n){var a;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H.get("/items/transcript?filter[gene][eq]=".concat(e));case 2:a=t.sent,n({type:ae.GET_GENE_COUNTS,payload:a.data.data});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},setTissue:function(e,t){return function(){var n=Object(m.a)(p.a.mark(function n(a){var r;return p.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=t>=0?t:null,n.next=3,H.post("/custom/data/tissue-data",{tissueId:e.id,amount:100,adult:t});case 3:r=n.sent,a({type:ae.SET_ACTIVE_TISSUE,payload:{activeTissue:e,data:r.data}});case 5:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}})(nt),rt=(n(290),n(584),n(300)),lt=Object(i.c)({suggestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae.GET_SUGGESTIONS:var n=[];return F.a.values(t.payload).forEach(function(e,t){e.symbol?n.push({title:"".concat(e.symbol," | ").concat(e.ensg),description:e.description,id:e.id,ensg:e.ensg,symbol:e.symbol}):n.push({title:"".concat(e.ensg),description:e.description,id:e.id,ensg:e.ensg})}),n;default:return e}},activeGene:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae.SET_ACTIVE_GENE:return t.payload;default:return e}},geneCounts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae.GET_GENE_COUNTS:return F.a.values(t.payload);case ae.SET_ACTIVE_GENE:return[];default:return e}},activeTissue:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae.SET_ACTIVE_TISSUE:return t.payload.activeTissue;default:return e}},tissueCounts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae.SET_ACTIVE_TISSUE:return t.payload.data.counts;default:return e}},tissueGenes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae.SET_ACTIVE_TISSUE:return t.payload.data.genes;default:return e}}}),ot=Object(i.c)({geneFinder:lt}),ct=Object(i.c)({form:rt.a,protocolStatus:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case ee:return ee;case te:return te;default:return""}},application:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ne:return t.payload;default:return e}},config:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Z:return t.payload;default:return e}},collections:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $:return t.payload;default:return e}},modules:ot}),it=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.d,st=Object(i.e)(ct,it(Object(i.a)(s.a)));o.a.render(r.a.createElement(c.a,{store:st},r.a.createElement(at,null)),document.getElementById("root"))}},[[366,1,2]]]);
//# sourceMappingURL=main.3ac1011c.chunk.js.map